
		<link rel='stylesheet' href='https://unpkg.com/leaflet@1.9.3/dist/leaflet.css' integrity='sha256-kLaT2GOSpHechhsozzB+flnD+zUyjE2LlfWPgU04xyI=' crossorigin=''/>
		<script src='https://unpkg.com/leaflet@1.9.3/dist/leaflet.js' integrity='sha256-WBkoXOwTeyKclOHuWtc+i2uENFpDZ9YPdf5Hf+D7ewM=' crossorigin=''></script>
		<div id='map' style='width: 100%; height: 95%; font-size: 25px; margin: 0; border-radius: 0px; border: 2px solid #3c546b;'></div>
<div style="margin: 10px 0;">    <input id="searchInput" type="text" placeholder="Rechercher par nom ou ID...">    <button onclick="validateSearch()">Rechercher</button>    <button onclick="resetSearch()">Réinitialiser</button>    <span id="searchResults"></span></div><script>
		window.jsonValues = [["ID","world_region","place_name","alt_name","geo_clue","geometry","type","biblio","Latitude","Longitude"],["0","Tunisie","Bulla","","","point","villes et domaines","","36.558800741051954","8.753890324119414"],["1","Tunisie","Capsa","Gafsa","","point","villes et domaines","","34.41678149094534","8.783467772370525"],["2","Tunisie","Carthage","","","point","villes et domaines","","36.850806409922974","10.328663013074339"],["3","Algérie","Thudedenses","","","point","villes et domaines","","36.57774243266451","2.5430522464753653"],["4","Tunisie","Volubilis","","","point","villes et domaines","","34.07282459447863","-5.554618554615739"],["5","Tunisie","Gilda (?)","Riha","","point","villes et domaines","","34.18366443451519","-5.555025682089317"],["6","Tunisie","Tingi","Tangier","","point","villes et domaines","","35.78336823394947","-5.816696932730005"],["7","Tunisie","Lixus","","","point","villes et domaines","","35.20083324400923","-6.098552567585296"],["8","Algérie","Cirta","","","point","villes et domaines","","36.36338070322103","6.607072682317123"],["9","Algérie","Regiae","Arbal","près d'Oran","polygone","villes et domaines","","35.45741168966","-0.6189451812869332"],["10","Tunisie","Fundus Villa Magna Variana siue Mappalia Siga","Henchir Mettich","","point","villes et domaines","","36.56587301385348","9.370575903723749"],["11","Algérie","statio Germaniniciana","","près d'Hippo regius","point","villes et domaines","","36.88338787538468","7.751911269883357"],["12","Algérie","Hippo (Regius)","","","polygon","villes et domaines","","36.88217983962333","7.749633804536083"],["13","Algérie","Icosium","Alger","","point","villes et domaines","","36.77649477807229","3.05852517226429"],["14","Algérie","Medracen","","","point","villes et domaines","","35.707103","6.434614"],["15","Algérie","Rusicade","","","point","villes et domaines","","36.86213536495874","6.9054114683460215"],["16","Tunisie","saltus Blandianus","","","polygon","villes et domaines","","36.44254531604506","9.195318517494009"],["17","Tunisie","saltus Lamianus","","","polygon","villes et domaines","","36.605963","9.24277"],["18","Tunisie","Sicca","Le Kef","","point","villes et domaines","","36.17382658344858","8.704080058583148"],["19","Algérie","Siga","","","point","villes et domaines","","36.272140","6.725088"],["20","Tunisie","Simitthus","","","point","villes et domaines","","36.49184915169899","8.574790540353776"],["21","Algérie","Statio Liviana","","","point","villes et domaines","","35.5005498","6.4844060"],["22","Algérie","Suthul","","","point","villes et domaines","","36.46684958609205","7.433337110788435"],["23","Tunisie","Thala","","","point","villes et domaines","","35.575759170222625","8.6699447911646"],["24","Tunisie","Thimida Regia","La Mohammedia (?)","","point","villes et domaines","","36.64092032076405","10.14192979819157"],["25","Tunisie","Thugga","","","point","villes et domaines","","36.420154","9.220169"],["26","Tunisie","Thysdrus","","","point","villes et domaines","","35.299991203369366","10.716717293299878"],["27","Algérie","Timgad","","","point","villes et domaines","","35.48726976368534","6.467676502830097"],["28","Algérie","Tipasa","","","point","villes et domaines","","36.59410844333932","2.443390206032822"],["29","Algérie","Mausolée royal (près de Tipasa)","","","point","villes et domaines","","36.57490257007058","2.552769549234054"],["30","Algérie","Iol/Caesarea","Cherchell","","point","villes et domaines","","36.60768055416968","2.1905412037127863"],["31","Tunisie","Utique","","","point","villes et domaines","","37.059456","10.063029"],["32","Tunisie","Vthina","","","point","villes et domaines","","36.610426042303494","10.1692145628974"],["33","Tunisie","Zama","","","point","villes et domaines","","36.11186690594038","9.285526022409872"],["34","Tunisie","Thapsus","","","point","villes et domaines","","35.625884343682955","11.045006739308022"],["35","Tunisie","Vaga","","près de Béja","point","villes et domaines","","36.732646004182854","9.18412018311437"],["36","Tunisie","Althiburos","","près de Kef","point","villes et domaines","","35.87340239139674","8.786692247677337"],["37","Tunisie","oued Siliana","","","polygon","rivière","","36.36277136874833","9.399142883589917"],["38","Tunisie","oued Tessa","","","polygon","rivière","","36.36086295733698","9.000347962130416"],["39","Tunisie","oued Soummam","","","polygon","rivière","","36.42748264591252","4.542761360867262"],["40","Tunisie","Jebel Messougue","Jabal Massougue","","polygon","massif","","36.062137664098586","9.220446574879288"],["41","Algérie","Némemcha","","","point","massif","","34.912194315546316","7.087160573117063"],["42","Algérie","Aurès","","","point","massif","","35.3333652897496","6.683399612244453"]];
		markersJsonGlobal = [{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/foncier.png"},{"customMarkerIcon":"assets/css/images/riviere.png"},{"customMarkerIcon":"assets/css/images/riviere.png"},{"customMarkerIcon":"assets/css/images/riviere.png"},{"customMarkerIcon":"assets/css/images/massif.png"},{"customMarkerIcon":"assets/css/images/massif.png"},{"customMarkerIcon":"assets/css/images/massif.png"}];

		isUsingDefaultMarkers = markersJsonGlobal !== null ? false : true;

		isUsingCustomIcon = true;

		isUsingLabelsForMarkers = [true,2];

		markers = [];

		var map = L.map('map').setView([31.74460524436231,4.7450595801782915], 6);

		var iPointsArray = [["36.558800741051954","8.753890324119414","ID = 0</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Bulla</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.558800741051954</br>LONGITUDE = 8.753890324119414"],["34.41678149094534","8.783467772370525","ID = 1</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Capsa</br>ALT_NAME = Gafsa</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 34.41678149094534</br>LONGITUDE = 8.783467772370525"],["36.850806409922974","10.328663013074339","ID = 2</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Carthage</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.850806409922974</br>LONGITUDE = 10.328663013074339"],["36.57774243266451","2.5430522464753653","ID = 3</br>WORLD_REGION = Algérie</br>PLACE_NAME = Thudedenses</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.57774243266451</br>LONGITUDE = 2.5430522464753653"],["34.07282459447863","-5.554618554615739","ID = 4</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Volubilis</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 34.07282459447863</br>LONGITUDE = -5.554618554615739"],["34.18366443451519","-5.555025682089317","ID = 5</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Gilda (?)</br>ALT_NAME = Riha</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 34.18366443451519</br>LONGITUDE = -5.555025682089317"],["35.78336823394947","-5.816696932730005","ID = 6</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Tingi</br>ALT_NAME = Tangier</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 35.78336823394947</br>LONGITUDE = -5.816696932730005"],["35.20083324400923","-6.098552567585296","ID = 7</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Lixus</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 35.20083324400923</br>LONGITUDE = -6.098552567585296"],["36.36338070322103","6.607072682317123","ID = 8</br>WORLD_REGION = Algérie</br>PLACE_NAME = Cirta</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.36338070322103</br>LONGITUDE = 6.607072682317123"],["35.45741168966","-0.6189451812869332","ID = 9</br>WORLD_REGION = Algérie</br>PLACE_NAME = Regiae</br>ALT_NAME = Arbal</br>GEO_CLUE = près d'Oran</br>GEOMETRY = polygone</br>TYPE = villes et domaines</br>LATITUDE = 35.45741168966</br>LONGITUDE = -0.6189451812869332"],["36.56587301385348","9.370575903723749","ID = 10</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Fundus Villa Magna Variana siue Mappalia Siga</br>ALT_NAME = Henchir Mettich</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.56587301385348</br>LONGITUDE = 9.370575903723749"],["36.88338787538468","7.751911269883357","ID = 11</br>WORLD_REGION = Algérie</br>PLACE_NAME = statio Germaniniciana</br>GEO_CLUE = près d'Hippo regius</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.88338787538468</br>LONGITUDE = 7.751911269883357"],["36.88217983962333","7.749633804536083","ID = 12</br>WORLD_REGION = Algérie</br>PLACE_NAME = Hippo (Regius)</br>GEOMETRY = polygon</br>TYPE = villes et domaines</br>LATITUDE = 36.88217983962333</br>LONGITUDE = 7.749633804536083"],["36.77649477807229","3.05852517226429","ID = 13</br>WORLD_REGION = Algérie</br>PLACE_NAME = Icosium</br>ALT_NAME = Alger</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.77649477807229</br>LONGITUDE = 3.05852517226429"],["35.707103","6.434614","ID = 14</br>WORLD_REGION = Algérie</br>PLACE_NAME = Medracen</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 35.707103</br>LONGITUDE = 6.434614"],["36.86213536495874","6.9054114683460215","ID = 15</br>WORLD_REGION = Algérie</br>PLACE_NAME = Rusicade</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.86213536495874</br>LONGITUDE = 6.9054114683460215"],["36.44254531604506","9.195318517494009","ID = 16</br>WORLD_REGION = Tunisie</br>PLACE_NAME = saltus Blandianus</br>GEOMETRY = polygon</br>TYPE = villes et domaines</br>LATITUDE = 36.44254531604506</br>LONGITUDE = 9.195318517494009"],["36.605963","9.24277","ID = 17</br>WORLD_REGION = Tunisie</br>PLACE_NAME = saltus Lamianus</br>GEOMETRY = polygon</br>TYPE = villes et domaines</br>LATITUDE = 36.605963</br>LONGITUDE = 9.24277"],["36.17382658344858","8.704080058583148","ID = 18</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Sicca</br>ALT_NAME = Le Kef</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.17382658344858</br>LONGITUDE = 8.704080058583148"],["36.272140","6.725088","ID = 19</br>WORLD_REGION = Algérie</br>PLACE_NAME = Siga</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.272140</br>LONGITUDE = 6.725088"],["36.49184915169899","8.574790540353776","ID = 20</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Simitthus</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.49184915169899</br>LONGITUDE = 8.574790540353776"],["35.5005498","6.4844060","ID = 21</br>WORLD_REGION = Algérie</br>PLACE_NAME = Statio Liviana</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 35.5005498</br>LONGITUDE = 6.4844060"],["36.46684958609205","7.433337110788435","ID = 22</br>WORLD_REGION = Algérie</br>PLACE_NAME = Suthul</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.46684958609205</br>LONGITUDE = 7.433337110788435"],["35.575759170222625","8.6699447911646","ID = 23</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Thala</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 35.575759170222625</br>LONGITUDE = 8.6699447911646"],["36.64092032076405","10.14192979819157","ID = 24</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Thimida Regia</br>ALT_NAME = La Mohammedia (?)</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.64092032076405</br>LONGITUDE = 10.14192979819157"],["36.420154","9.220169","ID = 25</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Thugga</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.420154</br>LONGITUDE = 9.220169"],["35.299991203369366","10.716717293299878","ID = 26</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Thysdrus</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 35.299991203369366</br>LONGITUDE = 10.716717293299878"],["35.48726976368534","6.467676502830097","ID = 27</br>WORLD_REGION = Algérie</br>PLACE_NAME = Timgad</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 35.48726976368534</br>LONGITUDE = 6.467676502830097"],["36.59410844333932","2.443390206032822","ID = 28</br>WORLD_REGION = Algérie</br>PLACE_NAME = Tipasa</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.59410844333932</br>LONGITUDE = 2.443390206032822"],["36.57490257007058","2.552769549234054","ID = 29</br>WORLD_REGION = Algérie</br>PLACE_NAME = Mausolée royal (près de Tipasa)</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.57490257007058</br>LONGITUDE = 2.552769549234054"],["36.60768055416968","2.1905412037127863","ID = 30</br>WORLD_REGION = Algérie</br>PLACE_NAME = Iol/Caesarea</br>ALT_NAME = Cherchell</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.60768055416968</br>LONGITUDE = 2.1905412037127863"],["37.059456","10.063029","ID = 31</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Utique</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 37.059456</br>LONGITUDE = 10.063029"],["36.610426042303494","10.1692145628974","ID = 32</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Vthina</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.610426042303494</br>LONGITUDE = 10.1692145628974"],["36.11186690594038","9.285526022409872","ID = 33</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Zama</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.11186690594038</br>LONGITUDE = 9.285526022409872"],["35.625884343682955","11.045006739308022","ID = 34</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Thapsus</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 35.625884343682955</br>LONGITUDE = 11.045006739308022"],["36.732646004182854","9.18412018311437","ID = 35</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Vaga</br>GEO_CLUE = près de Béja</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 36.732646004182854</br>LONGITUDE = 9.18412018311437"],["35.87340239139674","8.786692247677337","ID = 36</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Althiburos</br>GEO_CLUE = près de Kef</br>GEOMETRY = point</br>TYPE = villes et domaines</br>LATITUDE = 35.87340239139674</br>LONGITUDE = 8.786692247677337"],["36.36277136874833","9.399142883589917","ID = 37</br>WORLD_REGION = Tunisie</br>PLACE_NAME = oued Siliana</br>GEOMETRY = polygon</br>TYPE = rivière</br>LATITUDE = 36.36277136874833</br>LONGITUDE = 9.399142883589917"],["36.36086295733698","9.000347962130416","ID = 38</br>WORLD_REGION = Tunisie</br>PLACE_NAME = oued Tessa</br>GEOMETRY = polygon</br>TYPE = rivière</br>LATITUDE = 36.36086295733698</br>LONGITUDE = 9.000347962130416"],["36.42748264591252","4.542761360867262","ID = 39</br>WORLD_REGION = Tunisie</br>PLACE_NAME = oued Soummam</br>GEOMETRY = polygon</br>TYPE = rivière</br>LATITUDE = 36.42748264591252</br>LONGITUDE = 4.542761360867262"],["36.062137664098586","9.220446574879288","ID = 40</br>WORLD_REGION = Tunisie</br>PLACE_NAME = Jebel Messougue</br>ALT_NAME = Jabal Massougue</br>GEOMETRY = polygon</br>TYPE = massif</br>LATITUDE = 36.062137664098586</br>LONGITUDE = 9.220446574879288"],["34.912194315546316","7.087160573117063","ID = 41</br>WORLD_REGION = Algérie</br>PLACE_NAME = Némemcha</br>GEOMETRY = point</br>TYPE = massif</br>LATITUDE = 34.912194315546316</br>LONGITUDE = 7.087160573117063"],["35.3333652897496","6.683399612244453","ID = 42</br>WORLD_REGION = Algérie</br>PLACE_NAME = Aurès</br>GEOMETRY = point</br>TYPE = massif</br>LATITUDE = 35.3333652897496</br>LONGITUDE = 6.683399612244453"]];

		new L.tileLayer('https://{s}.basemaps.cartocdn.com/light_nolabels/{z}/{x}/{y}.png', {
		attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> <a href="https://github.com/zanniadevweb/cms_r-lite-web-gis">- Customized by Alexandre Zanni</a>',
		maxNativeZoom:19,
		maxZoom: 19,
		noWrap: true
		}).addTo(map);
		L.control.scale().addTo(map);

		var legend = L.control({position: 'bottomright'});
		legend.onAdd = function (map) {
			var div = L.DomUtil.create('div', 'leaflet-legend');
			div.style.background = 'white';
			div.style.padding = '8px 12px';
			div.style.border = '1px solid #ccc';
			div.style.borderRadius = '6px';
			div.style.boxShadow = '0 2px 6px rgba(0,0,0,0.1)';
			div.innerHTML = '<b>Communautés « royales » à l’époque impériale</b><br>' +
				'<span style="padding-right: 10px;"><img src="assets/css/images/region.png" style="width:18px; vertical-align:middle;"> Régions</span>'+
				'<span style="padding-right: 10px;"><img src="assets/css/images/riviere.png" style="width:18px; vertical-align:middle;"> Rivières</span>'+
				'<span style="padding-right: 10px;"><img src="assets/css/images/massif.png" style="width:18px; vertical-align:middle;"> Massifs</span>'+
				'<span style="padding-right: 10px;"><img src="assets/css/images/foncier.png" style="width:18px; vertical-align:middle;"> Villes et domaines</span>';
			return div;
		};
		legend.addTo(map);

		fillPolygons(["([35.77977805585362,9.050504101493805],[35.8233096624063,9.223295554563613],[35.82665100809128,9.300216924996981],[35.8143987195748,9.363402336424405],[35.81885431601799,9.430708535553617],[35.832219604966774,9.476037200273273],[35.841128547153026,9.54059620760128],[35.872524602137794,9.633176604836514],[35.88254199774158,9.705977187568093],[35.99487252353836,9.748558660486585],[36.04820134023323,9.858446332534285],[35.87029834220139,10.017783457003391],[35.70359687782023,10.115033946160441],[35.64801054141057,10.091100279168453],[35.54971929509653,9.732591749112878],[35.50611981205062,9.492212466508581],[35.599550179205174,9.14606629955837],[35.69220221142829,9.074639312727411]).color('#0000FF').tooltip(\"Gamonia\")","([36.973401486268976,8.835043809261625],[36.811968335304805,8.818563361160098],[36.76248179913255,8.851524257363115],[36.754781021371755,8.954527057997433],[36.802073585000215,9.168772883316898],[36.800974089371685,9.291002873402993],[36.73387501345752,9.310230062854728],[36.671857090296406,9.311298314556625],[36.57597962031319,9.325032021307866],[36.493230955613704,9.322285279957617],[36.34762414143665,9.244308438096512],[36.17120579794959,9.309162146448424],[36.09912160532716,9.343496413326502],[36.02129214792581,9.371878236163514],[36.03128686739051,9.444666881945105],[35.979078245142674,9.533935975828225],[35.97574460628572,9.595737656208827],[36.10454272279018,9.680886638066555],[36.217622059618144,9.759168766548642],[36.25638619336657,9.878652015284489],[36.257493457595814,10.010495600096474],[36.20100297630182,9.991268410644697],[36.07902191177118,9.989895039969594],[35.96699325004289,9.99013166709069],[35.886934823463996,9.995625149791184],[35.61948868471028,9.93794358143598],[35.36458359102387,9.9242098746847],[35.08640171396237,9.998371891141435],[34.86136788696068,10.27853950886685],[34.59277330863574,10.621882177648008],[34.82530513537327,10.902049795373426],[35.24131416432567,11.132776068794376],[35.38249803962288,11.033893380185408],[35.6462737286212,11.042133604236152],[35.82238438937915,10.63561588439925],[36.05979898109831,10.487596970459023],[36.36336469948377,10.531544832063032],[36.453983677690225,10.803472225737705],[36.85936027934991,11.113853998315847],[37.07001257883322,11.086386584813367],[37.05467222203909,10.90510165569692],[36.88133041489813,10.608453589870017],[36.70539251312352,10.435408884804312],[36.77361639770315,10.292578334591337],[36.857162918295394,10.363993609697825],[36.991086277043955,10.207429352733609],[37.13353243169839,10.201935870033115],[37.24311778062143,10.041731867143243],[37.35016769748693,9.753324025367085],[37.225266061306826,9.239979223657377]).color('#008000').tooltip(\"Fossa Regia\")","([36.6052563143485,10.17887343869878],[36.747322769002295,10.513975883429197],[36.6966935097859,10.634832502840146],[36.52805624670607,10.285996351358492]).color('#ff0000').tooltip(\"Domaine des descendants de Massinisa\")","([36.750001895695505,10.513009025972977],[36.77035354072058,10.549403348863796],[36.85829846684012,10.58236424506677],[36.880818087774834,10.61601182660734],[36.88246560427063,10.697040696439673],[37.008669347009395,10.90518271728824],[37.04813361894236,10.904496031950686],[37.05690067233302,10.976597992394728],[37.080632436667884,11.046888298709773],[37.044473125555434,11.075729082887397],[36.91997549116667,10.921224881935878],[36.699707324341944,10.635315999306691]).color('#ff0000').tooltip(\"Domaine du roi Hiempsal \")","([35.640607,11.031167],[35.235963,11.136003],[34.817085,10.901636],[34.24861266148712,10.077794353895491],[34.01674559147491,10.033846492291483],[33.679182367205385,10.34148152351942],[33.73401290837474,10.720531829853803],[33.893735210508254,10.951258103274714],[33.76141504943397,11.072114722685706],[33.6014458797995,11.059907281391766],[33.20252172564265,11.34007489911718],[32.78330250146915,12.636536816434832],[32.915243216082004,13.242136897732253],[32.66821817417845,14.263924680024946],[32.37567801600626,15.207582893322156],[31.5924229500195,15.503693902348068],[31.320672654022825,16.02008127619493],[31.18920109909928,16.986934231482664],[30.8597230888096,18.107604702384325],[30.273292239894317,18.23944828719631],[30.519646321200053,16.51449471923981],[30.888008674358808,14.91039777069426],[31.713985701874087,14.80052811668426],[32.29155098017978,13.33926171835169],[32.263688165014536,12.570174140281893],[32.52340783212989,11.05397291494432],[33.34395943506102,9.88935458243865],[34.16593700473694,9.66961527441873],[35.825866, 10.63878]).color('#FFD700').tooltip(\"Emporia\")","([36.53645448981752,8.720365902237761],[36.53645448981752,8.720365902237761],[36.589414527419514,8.82201199888185],[36.65666550418708,8.911295732420617],[36.69302271819199,9.026677788070648],[36.64123604174128,9.02118340446828],[36.65776749035264,9.158542994527867],[36.59713483247928,9.210739638750553],[36.485667061227595,9.092610391299278],[36.46357517782225,8.955250801239691],[36.407212379182084,8.87146145130333],[36.4337411477071,8.697014771927623],[36.494502051241085,8.691520388325253],[36.494502051241085,8.691520388325253]).color('#964B00').tooltip(\"Grandes Plaines\")","([36.71138324550857,10.431461168194863],[36.37588688057923,10.530360073037787],[36.44101550503684,10.78863993766759],[36.85540885602086,11.118302953810614],[37.07053700716563,11.08533665219632],[37.06615271488998,10.887538842510471],[36.88289549692522,10.60444949364803]).color('#FFA500').tooltip(\"Cap Bon\")","([37.01304153370097,10.190552611816358],[37.0223643701084,10.157586310202063],[37.02346109938929,10.10264247417821],[37.01962247763939,10.073110162315393],[36.98671205065274,10.058000607408829],[36.98177425793014,10.032589083247798],[36.84393566173141,9.9735244595222],[36.82145158583556,9.788797593137913],[36.59903521136095,9.560810857251104],[36.56232428453483,9.420796336747866],[36.63599976610829,9.377526078525984],[36.62222369292941,9.24904361866804],[36.59830258573972,9.068206276194699],[36.593864800769296,8.951214120207373],[36.51333375370209,8.772130050848885],[36.46254509612128,8.6553278146144],[36.46917158348044,8.5316548586014],[36.40818644907725,8.325533265246424],[36.32148758753881,8.115342164244543],[36.272787744519036,7.968308760984662],[36.29267542560717,7.948718867880574],[36.34026971317537,8.092946437443151],[36.42958138732385,8.309821402339265],[36.4963089112235,8.515311399371038],[36.492995985354014,8.658165373032995],[36.536052966028784,8.75294349017413],[36.623197514559735,8.932884553152208],[36.62650486233217,9.059255376007059],[36.66397821754884,9.241394158891037],[36.6771997541933,9.399357687459556],[36.60886403441447,9.439191968576843],[36.63311913212409,9.549079640624544],[36.842817034338836,9.761423848086666],[36.87249301462389,9.955100870070726],[36.99977708907352,10.004427758733826],[37.01732807376425,10.045635635751696],[37.048032544214905,10.066239574260628],[37.057900103981694,10.133546688044751],[37.056803872070425,10.185743332267396]).color('#62c0e3').tooltip(\"Medjerda\")","([35.7823378120272,9.050450140136101],[35.98728519342851,9.022614797909934],[36.13493561735288,9.161403337435637],[36.16731500801109,9.31200952336743],[36.136710165816446,9.69896844871185],[36.18881991783124,10.03425957390264],[36.04526821880518,9.987265497788075],[35.90968565830702,10.001006937345071],[36.049709604203805,9.859470109908003],[35.99861854663332,9.752286881363405],[35.883208801870346,9.706115636064762],[35.833123329800536,9.475259451507203],[35.82532941262126,9.222691767288238]).color('#FFC0CB').tooltip(\"Tushkat\")"]);

		for (var iPoints = 0; iPoints < iPointsArray.length; iPoints++) {
			createPoint(iPointsArray[iPoints][0],iPointsArray[iPoints][1],iPointsArray[iPoints][2], iPoints);
		}

		function fillPolygons(polygonLinesForHtmlExport) {
			if (polygonLinesForHtmlExport !== '') {
				if (polygonLinesForHtmlExport.includes('|')) {
					fillPolygonsLoop(polygonLinesForHtmlExport.split('|'));
				} else {
					fillPolygonsLoop(polygonLinesForHtmlExport);
				}
			}
		}

		function fillPolygonsLoop(polygonLinesFromFile) {
			var currPolyPointValues = '';
			var currPolyPointValSeparated = [];
			var currPolyPointValue = '';
			var currPolyPointValuesAsArray = [];
			var currPolyPointsColor = '';
			var currPolyPointsTooltip = '';
			for (var ipolygonLinesFromFile = 0; ipolygonLinesFromFile < polygonLinesFromFile.length; ipolygonLinesFromFile++) {
				if (polygonLinesFromFile[ipolygonLinesFromFile] !== '') {
					currPolyPointValues = polygonLinesFromFile[ipolygonLinesFromFile].split('.color')[0].replace('(','').replace(')','');
					currPolyPointsColor = polygonLinesFromFile[ipolygonLinesFromFile].split('.color(')[1].split(')')[0].replaceAll('\'','');
					currPolyPointsTooltip = polygonLinesFromFile[ipolygonLinesFromFile].split('.tooltip(')[1].replaceAll('"','').slice(0,-1);

					currPolyPointValSeparated = currPolyPointValues.split(']');
					for (var icurrPolyPointValues = 0; icurrPolyPointValues < currPolyPointValSeparated.length; icurrPolyPointValues++) {
						if ( currPolyPointValSeparated[icurrPolyPointValues] !== '') {
							currPolyPointValue = currPolyPointValSeparated[icurrPolyPointValues].split('[')[1];
							currPolyPointValuesAsArray.push(currPolyPointValue.replace(' ', '').split(','));
						}
					}
					createPolygon([currPolyPointValuesAsArray], currPolyPointsColor, currPolyPointsTooltip);
					currPolyPointValuesAsArray = [];
					currPolyPointsColor = '';
					currPolyPointsTooltip = '';
				}
			}
		}

		function createPolygon(polyPointsValues, polyPointsColor, polyPointsTooltip) {
			new L.polygon(polyPointsValues).setStyle({fillColor: polyPointsColor, color: polyPointsColor}).addTo(map).bindTooltip(polyPointsTooltip, {permanent: false, direction:"center"});
		}

		function createPoint(latitude, longitude, label, markerId) {
			if (isUsingCustomIcon === true && markersJsonGlobal !== null && markersJsonGlobal[markerId] !== undefined && markersJsonGlobal[markerId].customMarkerIcon) {
				var customMarkerIcon = L.icon({
					iconUrl: markersJsonGlobal[markerId].customMarkerIcon,
					// shadowUrl: 'leaf-shadow.png',
				
					iconSize:     [20, 30], // size of the icon
					// shadowSize:   [50, 64], // size of the shadow
					// iconAnchor:   [22, 94], // point of the icon which will correspond to marker's location
					// shadowAnchor: [4, 62],  // the same for the shadow
					// popupAnchor:  [-3, -76] // point from which the popup should open relative to the iconAnchor
				});
				var paramCustomMarkerIcon = {icon: customMarkerIcon};
				markers[markerId] = new L.marker([latitude,longitude], paramCustomMarkerIcon).bindPopup(label + '</br>').addTo(map);
			} else if (markersJsonGlobal !== null && markersJsonGlobal[markerId] !== undefined && markersJsonGlobal[markerId].fillColor) {
				var paramCustomMarkerIcon = {  
					fillColor: markersJsonGlobal[markerId].fillColor, // '#3CC1F1'
					fillOpacity: markersJsonGlobal[markerId].fillOpacity, // 1.0
					color: markersJsonGlobal[markerId].borderColor, // black
					weight: markersJsonGlobal[markerId].borderWeight,  // 0.2
					radius: markersJsonGlobal[markerId].circleRadius, // 2000
					stroke: markersJsonGlobal[markerId].hasBorder     // true,
				}
				markers[markerId] = new L.circle([latitude,longitude], paramCustomMarkerIcon).bindPopup(label + '</br>').addTo(map);
			} else {
				var customMarkerIcon = ""
				markers[markerId] = new L.marker([latitude,longitude], paramCustomMarkerIcon).bindPopup(label + '</br>').addTo(map);
			}
			if (isUsingLabelsForMarkers[0] && isUsingLabelsForMarkers[1]) {
				var labelText = '';
				try {
					var row = window.jsonValues && window.jsonValues[Number(markerId) + 1];
					var parts = [];
					for (var i = 1; i < isUsingLabelsForMarkers.length; i++) {
						var col = isUsingLabelsForMarkers[i];
						if (col === null || col === undefined || col === '') continue;
						var colIndex = Number(col);
						if (isNaN(colIndex)) continue;
						if (row && row[colIndex] !== undefined && String(row[colIndex]).trim() !== '') {
							parts.push(String(row[colIndex]).trim());
						}
					}
					// fallback if nothing collected
					if (parts.length === 0 && row) parts.push(String(row[2] || row[1] || row[0] || '').trim());
					labelText = parts.join(' - ');
				} catch (e) { labelText = ''; }
				if (labelText) {
					markers[markerId].bindTooltip(labelText, {
						permanent: true,
						direction: 'right',
						offset: [8, 0],
						className: 'marker-label'
					});
				}
				if (labelText) {
					markers[markerId].bindTooltip(labelText, {
						permanent: true,
						direction: 'right',
						offset: [8, 0],
						className: 'marker-label'
					});
				}
			(function insertMarkerLabelStyle(){
			if (document.getElementById('marker-label-style')) return;
                var css = [
                  ".leaflet-tooltip.marker-label, .marker-label {",
                  "  border: none !important;",
                  "  box-shadow: none !important;",
                  "  color: #000 !important;",
                  "  padding: 0 6px !important;",
                  "  white-space: nowrap;",
                  "  pointer-events: none;",
                  "  font-size: 13px;",
                  "  line-height: 1;",
                  "  text-shadow: none !important;",
                  "}",
                  ".leaflet-tooltip.marker-label::before, .marker-label::before {",
                  "  display: none !important;",
                  "}"
                ].join('\n');
				var style = document.createElement('style');
				style.id = 'marker-label-style';
				style.type = 'text/css';
				style.appendChild(document.createTextNode(css));
				document.head.appendChild(style);
			})();
			}
		}

		function validateSearch() {
            const query = document.getElementById('searchInput').value.trim().toLowerCase();
            if (!query) {
                alert("Veuillez saisir un terme de recherche");
                return;
            }
            markers.forEach(marker => map.removeLayer(marker));
            const results = markers.filter(marker => {
                const popupContent = marker.getPopup()?.getContent()?.toLowerCase() || "";
                return popupContent.includes(query);
            });
            results.forEach(marker => marker.addTo(map));
            if (results.length === 0) {
                document.getElementById('searchResults').textContent = "Aucun résultat trouvé";
                return;
            }
            map.fitBounds(L.featureGroup(results).getBounds());
            document.getElementById('searchResults').textContent = `${results.length} résultat(s) trouvé(s)`;
        }

        function resetSearch() {
            document.getElementById('searchInput').value = '';
            document.getElementById('searchResults').textContent = '';
            markers.forEach(marker => marker.addTo(map));
        }
	</script>